<?xml version="1.0" encoding="ISO-8859-1"?>
<!--Edited using Gateway Setup Editor version GA3.0.18-140320 at 2014-08-05 13:19:58 by apage on ITRSPC176-->
<gateway compatibility="1" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://schema.itrsgroup.com/GA3.0.6-130308/gateway.xsd">
	<includes>
		<priority>1</priority>
		<include>
			<priority>2</priority>
			<required>true</required>
			<location>config/netprobes</location>
		</include>
		<include>
			<priority>3</priority>
			<required>true</required>
			<location>config/managed_entities</location>
		</include>
		<includeGroup name="BASE COMMON">
			<include>
				<priority>14</priority>
				<required>true</required>
				<location>../../gateway_config/shared/ett/gateway_monitor_stats</location>
			</include>
			<include>
				<priority>23</priority>
				<required>true</required>
				<location>../../gateway_config/shared/ett/active times</location>
			</include>
			<include>
				<priority>27</priority>
				<required>true</required>
				<location>../../gateway_config/shared/ett/commands</location>
			</include>
			<include>
				<priority>30</priority>
				<required>true</required>
				<location>../../gateway_config/shared/ett/hardware</location>
			</include>
			<include>
				<priority>90</priority>
				<required>true</required>
				<location>../../gateway_config/shared/ett/base_static_variables</location>
			</include>
			<include>
				<priority>92</priority>
				<required>true</required>
				<location>../../gateway_config/shared/ett/knowledge_base</location>
			</include>
			<include>
				<priority>93</priority>
				<required>true</required>
				<location>../../gateway_config/shared/ett/database</location>
			</include>
			<include>
				<priority>222</priority>
				<required>true</required>
				<location>../../gateway_config/shared/ett/all_samplers</location>
			</include>
		</includeGroup>
		<includeGroup name="ETT COMMON">
			<include>
				<priority>28</priority>
				<required>true</required>
				<location>../../gateway_config/shared/ett/ett_samplers</location>
			</include>
			<include>
				<priority>7</priority>
				<required>true</required>
				<location>../../gateway_config/shared/ett/ett_rules</location>
			</include>
			<include>
				<priority>32</priority>
				<required>true</required>
				<location>../../gateway_config/shared/ett/ett_types</location>
			</include>
		</includeGroup>
	</includes>
	<types>
		<typeGroup name="Baseline">
			<type name="gateway">
				<sampler ref="Gateway Log"/>
			</type>
			<type name="unix">
				<var name="top_threshold">
					<string>0.3</string>
				</var>
				<sampler disabled="true" ref="unix-users"/>
				<sampler ref="ipc"/>
				<sampler ref="Linux Standard"/>
				<sampler ref="cpu-linux"/>
			</type>
			<type name="baseline">
				<sampler ref="hardware"/>
				<sampler ref="network"/>
				<sampler ref="disk"/>
				<sampler ref="tcp_links"/>
				<sampler ref="ftm"/>
				<sampler ref="deviceio"/>
				<sampler ref="top_cpu"/>
				<sampler ref="NetProbe Log"/>
				<sampler ref="top_mem"/>
			</type>
		</typeGroup>
	</types>
	<samplers>
		<samplerGroup name="Baseline">
			<sampler name="win-services">
				<plugin>
					<win-services>
						<services>
							<service>
								<data>NetprobeNT</data>
							</service>
							<service>
								<data>Netlogon</data>
							</service>
							<service>
								<data>DHCP</data>
							</service>
							<service>
								<data>PlugPlay</data>
							</service>
							<service>
								<data>MpsSvc</data>
							</service>
							<service>
								<data>LanmanWorkstation</data>
							</service>
						</services>
					</win-services>
				</plugin>
			</sampler>
			<sampler name="win-apps">
				<plugin>
					<winapps/>
				</plugin>
			</sampler>
			<sampler name="unix-users">
				<plugin>
					<su/>
				</plugin>
			</sampler>
			<sampler name="top_cpu">
				<var-group>
					<data>top</data>
				</var-group>
				<plugin>
					<top>
						<threshold>
							<var-thresholdParameter>
								<data>pcpu</data>
							</var-thresholdParameter>
							<greaterThanOrEqualTo>5</greaterThanOrEqualTo>
						</threshold>
					</top>
				</plugin>
			</sampler>
			<sampler name="top_mem">
				<var-group>
					<data>top</data>
				</var-group>
				<plugin>
					<top>
						<threshold>
							<var-thresholdParameter>
								<data>pmem</data>
							</var-thresholdParameter>
							<greaterThanOrEqualTo>25.0</greaterThanOrEqualTo>
						</threshold>
					</top>
				</plugin>
			</sampler>
			<sampler name="tcp_links">
				<plugin>
					<tcp-links>
						<localPorts>
							<port>
								<data>7036</data>
							</port>
						</localPorts>
						<command>
							<data>netstat -ant</data>
						</command>
						<nameContents>
							<showLocalAddress>
								<data>true</data>
							</showLocalAddress>
							<showLocalPort>
								<data>true</data>
							</showLocalPort>
							<showRemoteAddress>
								<data>true</data>
							</showRemoteAddress>
							<showRemotePort>
								<data>true</data>
							</showRemotePort>
						</nameContents>
					</tcp-links>
				</plugin>
			</sampler>
			<sampler name="perfmon">
				<group>perfmon</group>
				<sampleInterval>
					<data>305</data>
				</sampleInterval>
				<plugin>
					<perfmon>
						<template>
							<table>
								<objectID>Process</objectID>
								<instances>
									<instance>*</instance>
								</instances>
								<counters>
									<counter>
										<name>% User Time</name>
										<value>142</value>
									</counter>
									<counter>
										<name>% Privileged Time</name>
										<value>144</value>
									</counter>
									<counter>
										<name>Virtual Bytes Peak</name>
										<value>172</value>
									</counter>
									<counter>
										<name>Virtual Bytes</name>
										<value>174</value>
									</counter>
									<counter>
										<name>Page Faults/sec</name>
										<value>28</value>
									</counter>
									<counter>
										<name>Working Set Peak</name>
										<value>178</value>
									</counter>
									<counter>
										<name>Working Set</name>
										<value>180</value>
									</counter>
									<counter>
										<name>Page File Bytes Peak</name>
										<value>182</value>
									</counter>
									<counter>
										<name>Page File Bytes</name>
										<value>184</value>
									</counter>
									<counter>
										<name>Private Bytes</name>
										<value>186</value>
									</counter>
									<counter>
										<name>Thread Count</name>
										<value>680</value>
									</counter>
									<counter>
										<name>Priority Base</name>
										<value>682</value>
									</counter>
									<counter>
										<name>Elapsed Time</name>
										<value>684</value>
									</counter>
									<counter>
										<name>ID Process</name>
										<value>784</value>
									</counter>
									<counter>
										<name>Creating Process ID</name>
										<value>1410</value>
									</counter>
									<counter>
										<name>Pool Paged Bytes</name>
										<value>56</value>
									</counter>
									<counter>
										<name>Pool Nonpaged Bytes</name>
										<value>58</value>
									</counter>
									<counter>
										<name>Handle Count</name>
										<value>952</value>
									</counter>
									<counter>
										<name>IO Read Operations/sec</name>
										<value>1412</value>
									</counter>
									<counter>
										<name>IO Write Operations/sec</name>
										<value>1414</value>
									</counter>
									<counter>
										<name>IO Data Operations/sec</name>
										<value>1416</value>
									</counter>
									<counter>
										<name>IO Other Operations/sec</name>
										<value>1418</value>
									</counter>
									<counter>
										<name>IO Read Bytes/sec</name>
										<value>1420</value>
									</counter>
									<counter>
										<name>IO Write Bytes/sec</name>
										<value>1422</value>
									</counter>
									<counter>
										<name>IO Data Bytes/sec</name>
										<value>1424</value>
									</counter>
									<counter>
										<name>IO Other Bytes/sec</name>
										<value>1426</value>
									</counter>
								</counters>
							</table>
						</template>
					</perfmon>
				</plugin>
			</sampler>
			<sampler name="network">
				<group>Resources</group>
				<plugin>
					<network>
						<nicTool>
							<type>ethtool</type>
							<command>
								<data>sudo /sbin/ethtool</data>
							</command>
						</nicTool>
						<private/>
					</network>
				</plugin>
			</sampler>
			<sampler name="defaultNetwork">
				<group>Resources</group>
				<plugin>
					<network>
						<private/>
					</network>
				</plugin>
			</sampler>
			<sampler name="Linux Standard">
				<plugin>
					<processes>
						<processes>
							<process>
								<data>
									<alias>
										<data>sshd</data>
									</alias>
								</data>
							</process>
							<process>
								<processDescriptor ref="crond"/>
							</process>
							<process>
								<processDescriptor ref="gateway2"/>
							</process>
							<process>
								<data>
									<alias>
										<data>Netprobe 8801</data>
									</alias>
									<ID>
										<searchString>
											<data>netprobe.linux_64 8801</data>
										</searchString>
									</ID>
									<start>
										<data>/opt/geneos/netprobe/scripts/start_netprobe_8801 &amp;</data>
									</start>
									<stop>
										<data>/usr/bin/pkill -f 8801</data>
									</stop>
									<logFile>
										<data>/opt/geneos/netprobe/logs/netprobe.8801.log</data>
									</logFile>
								</data>
							</process>
						</processes>
						<!--Default settings have been used for these processes as no relevant processes descriptor could be found.-->
					</processes>
				</plugin>
				<group>Processes</group>
			</sampler>
			<sampler name="Vista Standard">
				<group>Processes</group>
				<sampleInterval>
					<data>5</data>
				</sampleInterval>
				<plugin>
					<processes>
						<processes>
							<process>
								<processDescriptor ref="sidebar"/>
							</process>
							<process>
								<data>
									<alias>
										<data>NetprobeNT</data>
									</alias>
								</data>
							</process>
							<process>
								<data>
									<alias>
										<data>explorer</data>
									</alias>
								</data>
							</process>
							<process>
								<data>
									<alias>
										<data>svchost</data>
									</alias>
								</data>
							</process>
							<process>
								<processDescriptor ref="cmd"/>
							</process>
							<process>
								<processDescriptor ref="outlook"/>
							</process>
							<process>
								<processDescriptor ref="notepad"/>
							</process>
							<process>
								<data>
									<alias>
										<data>vmware</data>
									</alias>
								</data>
							</process>
						</processes>
						<!--Settings to go with these processes have been copied from processes.-->
					</processes>
				</plugin>
			</sampler>
			<sampler name="Windows Netprobes">
				<group>Processes</group>
				<plugin>
					<processes>
						<processes>
							<process>
								<data>
									<alias>
										<data>NetprobeNTSTD</data>
									</alias>
								</data>
							</process>
							<process>
								<data>
									<alias>
										<data>NetprobeNTJVM</data>
									</alias>
								</data>
							</process>
							<process>
								<data>
									<alias>
										<data>NetprobeNTMQ</data>
									</alias>
								</data>
							</process>
							<process>
								<data>
									<alias>
										<data>NetprobeNTGISSING</data>
									</alias>
								</data>
							</process>
						</processes>
						<!--Settings to go with these processes have been copied from winxpnetprobes.-->
					</processes>
				</plugin>
			</sampler>
			<sampler name="Linux Netprobes">
				<group>Processes</group>
				<hideColumns>
					<column>percentCPU</column>
				</hideColumns>
				<plugin>
					<processes>
						<processes>
							<process>
								<processDescriptor ref="netprobe7031"/>
							</process>
							<process>
								<processDescriptor ref="netprobe7032"/>
							</process>
							<process>
								<processDescriptor ref="netprobe7033"/>
							</process>
							<process>
								<processDescriptor ref="netprobe7036"/>
								<!--Netprobe7034-->
							</process>
							<process>
								<processDescriptor ref="netprobe7037"/>
							</process>
							<process>
								<processDescriptor ref="netprobe7038"/>
							</process>
							<process>
								<processDescriptor ref="netprobe7040"/>
							</process>
							<process>
								<processDescriptor ref="webslinger"/>
							</process>
							<process>
								<processDescriptor ref="netprobe7034"/>
							</process>
							<process>
								<processDescriptor ref="netprobe7039"/>
							</process>
							<process>
								<processDescriptor ref="netprobe7044"/>
							</process>
							<process>
								<processDescriptor ref="netprobe7045"/>
							</process>
							<process>
								<processDescriptor ref="netprobe7046"/>
							</process>
							<process>
								<processDescriptor ref="netprobe7047"/>
							</process>
							<process>
								<processDescriptor ref="webserver"/>
							</process>
							<process>
								<processDescriptor ref="webmontage"/>
							</process>
							<process>
								<processDescriptor ref="netprobe7048"/>
							</process>
							<process>
								<processDescriptor ref="openaccess"/>
							</process>
						</processes>
						<!--Settings to go with these processes have been copied from linuxnetprobes.-->
					</processes>
				</plugin>
			</sampler>
			<sampler name="ipc">
				<plugin>
					<ipc/>
				</plugin>
			</sampler>
			<sampler name="defaultHardware">
				<group>Resources</group>
				<plugin>
					<hardware/>
				</plugin>
			</sampler>
			<sampler name="hardware">
				<group>Resources</group>
				<plugin>
					<hardware/>
				</plugin>
			</sampler>
			<sampler name="ftm">
				<!---->
				<group>FTM</group>
				<plugin>
					<ftm>
						<files>
							<file>
								<path>
									<data>/opt/geneos/netprobe/logs/netprobe.7031.log</data>
								</path>
								<expectedArrival>
									<data>05:35</data>
								</expectedArrival>
							</file>
						</files>
						<monitoringPeriod>
							<periodAlias>NOON_TO_NOON</periodAlias>
						</monitoringPeriod>
						<delayUnit>SECONDS</delayUnit>
						<sizeUnit>KILOBYTES</sizeUnit>
					</ftm>
				</plugin>
			</sampler>
			<sampler name="Windows Event Logs">
				<plugin>
					<fkm>
						<!--Default settings have been used for these files as no relevant fkm descriptor could be found.-->
						<files>
							<file>
								<source>
									<ntEventLog>APPLICATION</ntEventLog>
								</source>
								<failTable>
									<fkmTable ref="fails"/>
								</failTable>
								<warningTable>
									<fkmTable ref="warnings"/>
								</warningTable>
								<alias>
									<data>APPLICATION</data>
								</alias>
							</file>
							<file>
								<source>
									<ntEventLog>SYSTEM</ntEventLog>
								</source>
								<failTable>
									<fkmTable ref="fails"/>
								</failTable>
								<warningTable>
									<fkmTable ref="warnings"/>
								</warningTable>
								<alias>
									<data>SYSTEM</data>
								</alias>
							</file>
							<file>
								<source>
									<ntEventLog>SECURITY</ntEventLog>
								</source>
								<failTable>
									<fkmTable ref="fails"/>
								</failTable>
								<warningTable>
									<fkmTable ref="warnings"/>
								</warningTable>
								<alias>
									<data>SECURITY</data>
								</alias>
							</file>
						</files>
					</fkm>
				</plugin>
				<group>FKM</group>
			</sampler>
			<sampler name="Gateway Log">
				<plugin>
					<fkm>
						<!--Default settings have been used for these files as no relevant fkm descriptor could be found.-->
						<display>
							<triggerMode>MULTIPLE</triggerMode>
						</display>
						<isPCREMode>
							<data>true</data>
						</isPCREMode>
						<files>
							<file>
								<source>
									<filename>
										<data>/opt/geneos/gateway/logs/gateway2.7050.log</data>
									</filename>
								</source>
								<failTable>
									<fkmTable ref="fails"/>
								</failTable>
								<warningTable>
									<fkmTable ref="warnings"/>
								</warningTable>
								<alias>
									<data>gateway.log</data>
								</alias>
							</file>
						</files>
					</fkm>
				</plugin>
				<group>FKM</group>
			</sampler>
			<sampler name="NetProbe Log">
				<group>FKM</group>
				<sampleInterval>
					<data>5</data>
				</sampleInterval>
				<plugin>
					<fkm>
						<!--Settings to go with these files have been copied from fkm.-->
						<display>
							<triggerMode>MULTIPLE</triggerMode>
							<useFullPathInRowNames>
								<data>true</data>
							</useFullPathInRowNames>
						</display>
						<files>
							<file>
								<source>
									<filename>
										<data>/opt/geneos/netprobe/logs/netprobe.7031.log</data>
									</filename>
								</source>
								<failTable>
									<fkmTable ref="fails"/>
								</failTable>
								<warningTable>
									<fkmTable ref="warnings"/>
								</warningTable>
							</file>
						</files>
					</fkm>
				</plugin>
			</sampler>
			<sampler name="disk">
				<group>Resources</group>
				<plugin>
					<disk>
						<partitions>
							<partition>
								<path>
									<data>/</data>
								</path>
							</partition>
							<partition>
								<path>
									<data>/boot</data>
								</path>
							</partition>
							<partition>
								<path>
									<data>/dev/shm</data>
								</path>
							</partition>
						</partitions>
						<checkNFSPartitions>
							<data>true</data>
						</checkNFSPartitions>
					</disk>
				</plugin>
			</sampler>
			<sampler name="deviceio">
				<var-group>
					<data>Resources</data>
				</var-group>
				<plugin>
					<deviceio>
						<command>
							<data>/usr/bin/iostat</data>
						</command>
					</deviceio>
				</plugin>
			</sampler>
			<sampler name="cpu-linux">
				<group>Resources</group>
				<sampleInterval>
					<data>5</data>
				</sampleInterval>
				<plugin>
					<cpu/>
				</plugin>
				<dataviews>
					<dataview name="cpu-linux">
						<additions>
							<headlines>
								<headline>total_cpu_per_sample</headline>
							</headlines>
						</additions>
					</dataview>
				</dataviews>
			</sampler>
			<sampler name="cpu-compute">
				<group>Resources</group>
				<plugin>
					<cpu/>
				</plugin>
				<dataviews>
					<dataview name="cpu-compute">
						<additions>
							<columns>
								<column>10 minute max</column>
								<column>10 minute average</column>
								<column>10 minute min</column>
								<column>1 hour max</column>
								<column>1 hour average</column>
								<column>1 hour min</column>
							</columns>
						</additions>
					</dataview>
				</dataviews>
			</sampler>
			<sampler name="cpu-win">
				<group>Resources</group>
				<plugin>
					<cpu/>
				</plugin>
			</sampler>
		</samplerGroup>
	</samplers>
	<commands>
		<command name="linux Standard - Netprobe - generate error">
			<label>Fake error in Log</label>
			<targets>
				<target>/geneos/gateway[(@name=&quot;ETT UK&quot;)]/directory/probe[(@name=&quot;GenericProbe2&quot;)]/managedEntity[(@name=&quot;LON020ALGO&quot;)]/sampler[(@name=&quot;NetProbe Log&quot;)][(@type=&quot;baseline&quot;)]/dataview[(@name=&quot;NetProbe Log&quot;)]/rows/row[(@name=&quot;/opt/geneos/netprobe/logs/netprobe.7031.log&quot;)]/cell[(@column=&quot;status&quot;)]</target>
			</targets>
			<userCommand>
				<type>script</type>
				<runLocation>gateway</runLocation>
				<args>
					<arg>
						<static>/opt/geneos/gateway/resources/command_scripts/error_in_log</static>
					</arg>
				</args>
			</userCommand>
		</command>
		<command name="Raise JIRA">
			<targets>
				<target>/geneos/gateway[(@name=&quot;ETT UK&quot;)]/directory/probe[(@name=&quot;GenericProbe2&quot;)]/managedEntity[(@name=&quot;LON020ALGO&quot;)]/sampler[(@name=&quot;Algo Processes&quot;)][(@type=&quot;&quot;)]/dataview[(@name=&quot;Algo Processes&quot;)]/rows/row[(@name=&quot;Algo_process&quot;)]/cell[(@column=&quot;instanceCount&quot;)]</target>
			</targets>
			<userCommand>
				<type>script</type>
				<runLocation>gateway</runLocation>
				<args>
					<arg>
						<userInput>
							<description>Severity</description>
							<options>
								<option>
									<label>SEVERITY 1</label>
									<value>1</value>
								</option>
								<option>
									<label>SEVERITY 2</label>
									<value>2</value>
								</option>
								<option>
									<label>SEVERITY 3</label>
									<value>3</value>
								</option>
							</options>
						</userInput>
					</arg>
					<arg>
						<userInput>
							<description>APP</description>
							<xpathOptions>
								<xpathOption>ancestor-or-self::managedEntity/@name</xpathOption>
							</xpathOptions>
						</userInput>
					</arg>
					<arg>
						<userInput>
							<description>SERVER</description>
							<xpathOptions>
								<xpathOption>ancestor-or-self::probe/parameters/@HostName</xpathOption>
							</xpathOptions>
						</userInput>
					</arg>
					<arg>
						<userInput>
							<description>REGION</description>
							<options>
								<option>
									<label>EMEA</label>
									<value>E</value>
								</option>
								<option>
									<label>APAC</label>
									<value>A</value>
								</option>
								<option>
									<label>NAM</label>
									<value>N</value>
								</option>
							</options>
						</userInput>
					</arg>
					<arg>
						<userInput>
							<description>PLATFORM</description>
							<singleLineString>ELECTRONIC TRADING</singleLineString>
						</userInput>
					</arg>
				</args>
			</userCommand>
		</command>
	</commands>
	<rules>
		<ruleGroup name="baseline">
			<rule name="cpu_percentutilisation">
				<targets>
					<target>/geneos/gateway/directory/probe/managedEntity/sampler[(param(&quot;PluginName&quot;)=&quot;CPU&quot;)]/dataview/rows/row/cell[(@column=&quot;percentUtilisation&quot;)]</target>
				</targets>
				<priority>1</priority>
				<block>
					<if>
						<equal>
							<dataItem>
								<property>@value</property>
							</dataItem>
							<string/>
						</equal>
						<transaction>
							<update>
								<property>state/@severity</property>
								<severity>undefined</severity>
							</update>
						</transaction>
					</if>
					<if>
						<gt>
							<dataItem>
								<property>@value</property>
							</dataItem>
							<integer>50</integer>
						</gt>
						<transaction>
							<update>
								<property>state/@severity</property>
								<severity>warning</severity>
							</update>
						</transaction>
						<if>
							<gt>
								<dataItem>
									<property>@value</property>
								</dataItem>
								<integer>65</integer>
							</gt>
							<transaction>
								<update>
									<property>state/@severity</property>
									<severity>critical</severity>
								</update>
							</transaction>
							<transaction>
								<update>
									<property>state/@severity</property>
									<severity>ok</severity>
								</update>
							</transaction>
						</if>
					</if>
				</block>
			</rule>
			<rule name="cpu_percent_time">
				<targets>
					<target>/geneos/gateway/directory/probe/managedEntity/sampler[(param(&quot;PluginName&quot;)=&quot;CPU&quot;)]/dataview/rows/row/cell[wild(@column,&quot;percent*Time&quot;)]</target>
				</targets>
				<priority>2</priority>
				<block>
					<if>
						<equal>
							<dataItem>
								<property>@value</property>
							</dataItem>
							<string/>
						</equal>
						<transaction>
							<update>
								<property>state/@severity</property>
								<severity>undefined</severity>
							</update>
						</transaction>
					</if>
					<if>
						<gt>
							<dataItem>
								<property>@value</property>
							</dataItem>
							<integer>50</integer>
						</gt>
						<transaction>
							<update>
								<property>state/@severity</property>
								<severity>warning</severity>
							</update>
						</transaction>
						<if>
							<gt>
								<dataItem>
									<property>@value</property>
								</dataItem>
								<integer>65</integer>
							</gt>
							<transaction>
								<update>
									<property>state/@severity</property>
									<severity>critical</severity>
								</update>
							</transaction>
							<transaction>
								<update>
									<property>state/@severity</property>
									<severity>ok</severity>
								</update>
							</transaction>
						</if>
					</if>
				</block>
			</rule>
			<rule name="cpu_time">
				<targets>
					<target>/geneos/gateway/directory/probe/managedEntity/sampler[(param(&quot;PluginName&quot;)=&quot;CPU&quot;)]/dataview/rows/row/cell[wild(@column,&quot;%*Time&quot;)]</target>
				</targets>
				<priority>3</priority>
				<block>
					<if>
						<equal>
							<dataItem>
								<property>@value</property>
							</dataItem>
							<string/>
						</equal>
						<transaction>
							<update>
								<property>state/@severity</property>
								<severity>undefined</severity>
							</update>
						</transaction>
					</if>
					<if>
						<gt>
							<dataItem>
								<property>@value</property>
							</dataItem>
							<integer>50</integer>
						</gt>
						<transaction>
							<update>
								<property>state/@severity</property>
								<severity>warning</severity>
							</update>
						</transaction>
						<if>
							<gt>
								<dataItem>
									<property>@value</property>
								</dataItem>
								<integer>65</integer>
							</gt>
							<transaction>
								<update>
									<property>state/@severity</property>
									<severity>critical</severity>
								</update>
							</transaction>
							<transaction>
								<update>
									<property>state/@severity</property>
									<severity>ok</severity>
								</update>
							</transaction>
						</if>
					</if>
				</block>
			</rule>
			<rule name="nt-hardware_cpuutilisation_value">
				<targets>
					<target>/geneos/gateway/directory/probe/managedEntity/sampler[@type=&quot;baseline&quot;]/dataview[@name=&quot;nt-hardware&quot;]/rows/row[@name=&quot;cpuUtilisation&quot;]/cell[@column=&quot;Value&quot;]</target>
				</targets>
				<priority>4</priority>
				<block>
					<if>
						<equal>
							<dataItem>
								<property>@value</property>
							</dataItem>
							<string/>
						</equal>
						<transaction>
							<update>
								<property>state/@severity</property>
								<severity>undefined</severity>
							</update>
						</transaction>
					</if>
					<if>
						<gt>
							<dataItem>
								<property>@value</property>
							</dataItem>
							<integer>80</integer>
						</gt>
						<transaction>
							<update>
								<property>state/@severity</property>
								<severity>warning</severity>
							</update>
						</transaction>
						<if>
							<gt>
								<dataItem>
									<property>@value</property>
								</dataItem>
								<integer>90</integer>
							</gt>
							<transaction>
								<update>
									<property>state/@severity</property>
									<severity>critical</severity>
								</update>
							</transaction>
							<transaction>
								<update>
									<property>state/@severity</property>
									<severity>ok</severity>
								</update>
							</transaction>
						</if>
					</if>
				</block>
			</rule>
			<rule name="nt-hardware_swapused_value">
				<targets>
					<target>/geneos/gateway/directory/probe/managedEntity/sampler[@type=&quot;baseline&quot;]/dataview[@name=&quot;nt-hardware&quot;]/rows/row[@name=&quot;swapUsed&quot;]/cell[@column=&quot;Value&quot;]</target>
				</targets>
				<priority>5</priority>
				<block>
					<if>
						<equal>
							<dataItem>
								<property>@value</property>
							</dataItem>
							<string/>
						</equal>
						<transaction>
							<update>
								<property>state/@severity</property>
								<severity>undefined</severity>
							</update>
						</transaction>
					</if>
					<if>
						<gt>
							<dataItem>
								<property>@value</property>
							</dataItem>
							<integer>50</integer>
						</gt>
						<transaction>
							<update>
								<property>state/@severity</property>
								<severity>warning</severity>
							</update>
						</transaction>
						<if>
							<gt>
								<dataItem>
									<property>@value</property>
								</dataItem>
								<integer>65</integer>
							</gt>
							<transaction>
								<update>
									<property>state/@severity</property>
									<severity>critical</severity>
								</update>
							</transaction>
							<transaction>
								<update>
									<property>state/@severity</property>
									<severity>ok</severity>
								</update>
							</transaction>
						</if>
					</if>
				</block>
			</rule>
			<rule name="hardware_cpuutilisation_value">
				<targets>
					<target>/geneos/gateway/directory/probe/managedEntity/sampler[(param(&quot;PluginName&quot;)=&quot;HARDWARE&quot;)]/dataview/rows/row[(@name=&quot;cpuUtilisation&quot;)]/cell[(@column=&quot;Value&quot;)]</target>
				</targets>
				<priority>6</priority>
				<block>
					<if>
						<equal>
							<dataItem>
								<property>@value</property>
							</dataItem>
							<string/>
						</equal>
						<transaction>
							<update>
								<property>state/@severity</property>
								<severity>undefined</severity>
							</update>
						</transaction>
					</if>
					<if>
						<gt>
							<dataItem>
								<property>@value</property>
							</dataItem>
							<integer>80</integer>
						</gt>
						<transaction>
							<update>
								<property>state/@severity</property>
								<severity>warning</severity>
							</update>
						</transaction>
						<if>
							<gt>
								<dataItem>
									<property>@value</property>
								</dataItem>
								<integer>90</integer>
							</gt>
							<transaction>
								<update>
									<property>state/@severity</property>
									<severity>critical</severity>
								</update>
							</transaction>
							<transaction>
								<update>
									<property>state/@severity</property>
									<severity>ok</severity>
								</update>
							</transaction>
						</if>
					</if>
				</block>
			</rule>
			<rule name="hardware_swapused_value">
				<targets>
					<target>/geneos/gateway/directory/probe/managedEntity/sampler[(param(&quot;PluginName&quot;)=&quot;HARDWARE&quot;)]/dataview/rows/row[(@name=&quot;swapUsed&quot;)]/cell[(@column=&quot;Value&quot;)]</target>
				</targets>
				<priority>7</priority>
				<block>
					<if>
						<equal>
							<dataItem>
								<property>@value</property>
							</dataItem>
							<string/>
						</equal>
						<transaction>
							<update>
								<property>state/@severity</property>
								<severity>undefined</severity>
							</update>
						</transaction>
					</if>
					<if>
						<gt>
							<dataItem>
								<property>@value</property>
							</dataItem>
							<integer>80</integer>
						</gt>
						<transaction>
							<update>
								<property>state/@severity</property>
								<severity>warning</severity>
							</update>
						</transaction>
						<if>
							<gt>
								<dataItem>
									<property>@value</property>
								</dataItem>
								<integer>90</integer>
							</gt>
							<transaction>
								<update>
									<property>state/@severity</property>
									<severity>critical</severity>
								</update>
							</transaction>
							<transaction>
								<update>
									<property>state/@severity</property>
									<severity>ok</severity>
								</update>
							</transaction>
						</if>
					</if>
				</block>
			</rule>
			<rule name="hardware_zombieprocesses_value">
				<targets>
					<target>/geneos/gateway/directory/probe/managedEntity/sampler[(param(&quot;PluginName&quot;)=&quot;HARDWARE&quot;)]/dataview/rows/row[(@name=&quot;zombieProcesses&quot;)]/cell[(@column=&quot;Value&quot;)]</target>
				</targets>
				<priority>8</priority>
				<block>
					<if>
						<equal>
							<dataItem>
								<property>@value</property>
							</dataItem>
							<string/>
						</equal>
						<transaction>
							<update>
								<property>state/@severity</property>
								<severity>undefined</severity>
							</update>
						</transaction>
					</if>
					<if>
						<gt>
							<dataItem>
								<property>@value</property>
							</dataItem>
							<integer>0</integer>
						</gt>
						<transaction>
							<update>
								<property>state/@severity</property>
								<severity>warning</severity>
							</update>
						</transaction>
						<transaction>
							<update>
								<property>state/@severity</property>
								<severity>ok</severity>
							</update>
						</transaction>
					</if>
				</block>
			</rule>
			<rule name="network_eth_status">
				<targets>
					<target>/geneos/gateway/directory/probe/managedEntity/sampler[(param(&quot;PluginName&quot;)=&quot;NETWORK&quot;)]/dataview/rows/row[wild(@name,&quot;eth*&quot;)]/cell[(@column=&quot;status&quot;)]</target>
				</targets>
				<priority>9</priority>
				<block>
					<if>
						<equal>
							<dataItem>
								<property>@value</property>
							</dataItem>
							<string/>
						</equal>
						<transaction>
							<update>
								<property>state/@severity</property>
								<severity>undefined</severity>
							</update>
						</transaction>
					</if>
					<if>
						<like>
							<dataItem>
								<property>@value</property>
							</dataItem>
							<string>DOWN</string>
						</like>
						<transaction>
							<update>
								<property>state/@severity</property>
								<severity>critical</severity>
							</update>
						</transaction>
						<transaction>
							<update>
								<property>state/@severity</property>
								<severity>ok</severity>
							</update>
						</transaction>
					</if>
				</block>
			</rule>
			<rule name="network_percentcollisions">
				<targets>
					<target>/geneos/gateway/directory/probe/managedEntity/sampler[param(&quot;PluginName&quot;)=&quot;NETWORK&quot;][@type=&quot;baseline&quot;]/dataview/rows/row/cell[@column=&quot;percentCollisions&quot;]</target>
				</targets>
				<priority>10</priority>
				<block>
					<if>
						<equal>
							<dataItem>
								<property>@value</property>
							</dataItem>
							<string/>
						</equal>
						<transaction>
							<update>
								<property>state/@severity</property>
								<severity>undefined</severity>
							</update>
						</transaction>
					</if>
					<if>
						<gt>
							<dataItem>
								<property>@value</property>
							</dataItem>
							<integer>20</integer>
						</gt>
						<transaction>
							<update>
								<property>state/@severity</property>
								<severity>warning</severity>
							</update>
						</transaction>
						<transaction>
							<update>
								<property>state/@severity</property>
								<severity>ok</severity>
							</update>
						</transaction>
					</if>
				</block>
			</rule>
			<rule name="network_percent_errors">
				<targets>
					<target>/geneos/gateway/directory/probe/managedEntity/sampler[param(&quot;PluginName&quot;)=&quot;NETWORK&quot;][@type=&quot;baseline&quot;]/dataview/rows/row/cell[wild(@column,&quot;percent*Errors&quot;)]</target>
				</targets>
				<priority>11</priority>
				<block>
					<if>
						<equal>
							<dataItem>
								<property>@value</property>
							</dataItem>
							<string/>
						</equal>
						<transaction>
							<update>
								<property>state/@severity</property>
								<severity>undefined</severity>
							</update>
						</transaction>
					</if>
					<if>
						<gt>
							<dataItem>
								<property>@value</property>
							</dataItem>
							<integer>20</integer>
						</gt>
						<transaction>
							<update>
								<property>state/@severity</property>
								<severity>warning</severity>
							</update>
						</transaction>
						<transaction>
							<update>
								<property>state/@severity</property>
								<severity>ok</severity>
							</update>
						</transaction>
					</if>
				</block>
			</rule>
			<rule name="disk_percentageused_master">
				<targets>
					<target>/geneos/gateway/directory/probe/managedEntity/sampler[(@name=&quot;disk&quot;)]/dataview[(@name=&quot;disk&quot;)]/rows/row[(@name=&quot;/dev/pts&quot;)]/cell[(@column=&quot;percentageUsed&quot;)]</target>
					<target>/geneos/gateway/directory/probe/managedEntity/sampler[(@name=&quot;disk&quot;)]/dataview[(@name=&quot;disk&quot;)]/rows/row[(@name=&quot;/proc&quot;)]/cell[(@column=&quot;percentageUsed&quot;)]</target>
					<target>/geneos/gateway/directory/probe/managedEntity/sampler[(@name=&quot;disk&quot;)]/dataview[(@name=&quot;disk&quot;)]/rows/row[(@name=&quot;/proc/fs/vmblock/mountPoint&quot;)]/cell[(@column=&quot;percentageUsed&quot;)]</target>
					<target>/geneos/gateway/directory/probe/managedEntity/sampler[(@name=&quot;disk&quot;)]/dataview[(@name=&quot;disk&quot;)]/rows/row[(@name=&quot;/proc/sys/fs/binfmt_misc&quot;)]/cell[(@column=&quot;percentageUsed&quot;)]</target>
					<target>/geneos/gateway/directory/probe/managedEntity/sampler[(@name=&quot;disk&quot;)]/dataview[(@name=&quot;disk&quot;)]/rows/row[(@name=&quot;/sys&quot;)]/cell[(@column=&quot;percentageUsed&quot;)]</target>
					<target>/geneos/gateway/directory/probe/managedEntity/sampler[(@name=&quot;disk&quot;)]/dataview[(@name=&quot;disk&quot;)]/rows/row[(@name=&quot;/sys/fs/fuse/connections&quot;)]/cell[(@column=&quot;percentageUsed&quot;)]</target>
					<target>/geneos/gateway/directory/probe/managedEntity/sampler[(@name=&quot;disk&quot;)]/dataview[(@name=&quot;disk&quot;)]/rows/row[(@name=&quot;/var/lib/nfs/rpc_pipefs&quot;)]/cell[(@column=&quot;percentageUsed&quot;)]</target>
					<target>/geneos/gateway/directory/probe/managedEntity/sampler[(@name=&quot;disk&quot;)]/dataview[(@name=&quot;disk&quot;)]/rows/row[(@name=&quot;/home/presales/.gvfs&quot;)]/cell[(@column=&quot;percentageUsed&quot;)]</target>
				</targets>
				<priority>1</priority>
				<block>
					<transaction>
						<update>
							<property>state/@severity</property>
							<severity>undefined</severity>
						</update>
					</transaction>
				</block>
			</rule>
			<rule name="disk_percentageused_sub">
				<targets>
					<target>/geneos/gateway/directory/probe/managedEntity/sampler[(param(&quot;PluginName&quot;)=&quot;DISK&quot;)]/dataview/rows/row/cell[(@column=&quot;percentageUsed&quot;)]</target>
				</targets>
				<priority>12</priority>
				<block>
					<if>
						<equal>
							<dataItem>
								<property>@value</property>
							</dataItem>
							<string/>
						</equal>
						<transaction>
							<update>
								<property>state/@severity</property>
								<severity>undefined</severity>
							</update>
						</transaction>
					</if>
					<if>
						<gt>
							<dataItem>
								<property>@value</property>
							</dataItem>
							<integer>90</integer>
						</gt>
						<transaction>
							<update>
								<property>state/@severity</property>
								<severity>warning</severity>
							</update>
						</transaction>
						<if>
							<gt>
								<dataItem>
									<property>@value</property>
								</dataItem>
								<integer>95</integer>
							</gt>
							<transaction>
								<update>
									<property>state/@severity</property>
									<severity>critical</severity>
								</update>
							</transaction>
							<transaction>
								<update>
									<property>state/@severity</property>
									<severity>ok</severity>
								</update>
							</transaction>
						</if>
					</if>
				</block>
			</rule>
			<rule name="disk_c_percentageused">
				<targets>
					<target>/geneos/gateway/directory/probe/managedEntity/sampler[(@type=&quot;baseline&quot;)][(param(&quot;PluginName&quot;)=&quot;DISK&quot;)]/dataview/rows/row[(@name=&quot;C:&quot;)]/cell[(@column=&quot;percentageUsed&quot;)]</target>
				</targets>
				<priority>13</priority>
				<block>
					<if>
						<equal>
							<dataItem>
								<property>@value</property>
							</dataItem>
							<string/>
						</equal>
						<transaction>
							<update>
								<property>state/@severity</property>
								<severity>undefined</severity>
							</update>
						</transaction>
					</if>
					<if>
						<gt>
							<dataItem>
								<property>@value</property>
							</dataItem>
							<integer>80</integer>
						</gt>
						<transaction>
							<update>
								<property>state/@severity</property>
								<severity>warning</severity>
							</update>
						</transaction>
						<if>
							<gt>
								<dataItem>
									<property>@value</property>
								</dataItem>
								<integer>85</integer>
							</gt>
							<transaction>
								<update>
									<property>state/@severity</property>
									<severity>critical</severity>
								</update>
							</transaction>
							<transaction>
								<update>
									<property>state/@severity</property>
									<severity>ok</severity>
								</update>
							</transaction>
						</if>
					</if>
				</block>
			</rule>
			<rule name="nt-network_utilisationpercentage_">
				<targets>
					<target>/geneos/gateway/directory/probe/managedEntity/sampler[@type=&quot;baseline&quot;]/dataview[@name=&quot;nt-network&quot;]/rows/row/cell[@column=&quot;utilisationPercentage&quot;]</target>
				</targets>
				<priority>14</priority>
				<block>
					<if>
						<equal>
							<dataItem>
								<property>@value</property>
							</dataItem>
							<string/>
						</equal>
						<transaction>
							<update>
								<property>state/@severity</property>
								<severity>undefined</severity>
							</update>
						</transaction>
					</if>
					<if>
						<gt>
							<dataItem>
								<property>@value</property>
							</dataItem>
							<integer>50</integer>
						</gt>
						<transaction>
							<update>
								<property>state/@severity</property>
								<severity>warning</severity>
							</update>
						</transaction>
						<if>
							<gt>
								<dataItem>
									<property>@value</property>
								</dataItem>
								<integer>65</integer>
							</gt>
							<transaction>
								<update>
									<property>state/@severity</property>
									<severity>critical</severity>
								</update>
							</transaction>
							<transaction>
								<update>
									<property>state/@severity</property>
									<severity>ok</severity>
								</update>
							</transaction>
						</if>
					</if>
				</block>
			</rule>
			<rule name="nt-network_packet_discardedrate_">
				<targets>
					<target>/geneos/gateway/directory/probe/managedEntity/sampler[@type=&quot;baseline&quot;]/dataview[@name=&quot;nt-network&quot;]/rows/row/cell[wild(@column,&quot;packet*DiscardedRate&quot;)]</target>
				</targets>
				<priority>15</priority>
				<block>
					<if>
						<equal>
							<dataItem>
								<property>@value</property>
							</dataItem>
							<string/>
						</equal>
						<transaction>
							<update>
								<property>state/@severity</property>
								<severity>undefined</severity>
							</update>
						</transaction>
					</if>
					<if>
						<gt>
							<dataItem>
								<property>@value</property>
							</dataItem>
							<integer>5</integer>
						</gt>
						<transaction>
							<update>
								<property>state/@severity</property>
								<severity>warning</severity>
							</update>
						</transaction>
						<if>
							<gt>
								<dataItem>
									<property>@value</property>
								</dataItem>
								<integer>10</integer>
							</gt>
							<transaction>
								<update>
									<property>state/@severity</property>
									<severity>critical</severity>
								</update>
							</transaction>
							<transaction>
								<update>
									<property>state/@severity</property>
									<severity>ok</severity>
								</update>
							</transaction>
						</if>
					</if>
				</block>
			</rule>
			<rule name="nt-network_packet_errorrate_">
				<targets>
					<target>/geneos/gateway/directory/probe/managedEntity/sampler[@type=&quot;baseline&quot;]/dataview[@name=&quot;nt-network&quot;]/rows/row/cell[wild(@column,&quot;packet*ErrorRate&quot;)]</target>
				</targets>
				<priority>16</priority>
				<block>
					<if>
						<equal>
							<dataItem>
								<property>@value</property>
							</dataItem>
							<string/>
						</equal>
						<transaction>
							<update>
								<property>state/@severity</property>
								<severity>undefined</severity>
							</update>
						</transaction>
					</if>
					<if>
						<gt>
							<dataItem>
								<property>@value</property>
							</dataItem>
							<integer>5</integer>
						</gt>
						<transaction>
							<update>
								<property>state/@severity</property>
								<severity>warning</severity>
							</update>
						</transaction>
						<if>
							<gt>
								<dataItem>
									<property>@value</property>
								</dataItem>
								<integer>10</integer>
							</gt>
							<transaction>
								<update>
									<property>state/@severity</property>
									<severity>critical</severity>
								</update>
							</transaction>
							<transaction>
								<update>
									<property>state/@severity</property>
									<severity>ok</severity>
								</update>
							</transaction>
						</if>
					</if>
				</block>
			</rule>
			<rule name="tcp_links_state">
				<targets>
					<target>/geneos/gateway/directory/probe/managedEntity/sampler[@type=&quot;baseline&quot;]/dataview[@name=&quot;tcp_links&quot;]/rows/row/cell[@column=&quot;state&quot;]</target>
				</targets>
				<priority>15</priority>
				<block>
					<if>
						<equal>
							<dataItem>
								<property>@value</property>
							</dataItem>
							<string/>
						</equal>
						<transaction>
							<update>
								<property>state/@severity</property>
								<severity>undefined</severity>
							</update>
						</transaction>
					</if>
					<if>
						<and>
							<unlike>
								<dataItem>
									<property>@value</property>
								</dataItem>
								<string>ESTABLISHED</string>
							</unlike>
							<unlike>
								<dataItem>
									<property>@value</property>
								</dataItem>
								<string>LISTEN</string>
							</unlike>
						</and>
						<transaction>
							<update>
								<property>state/@severity</property>
								<severity>warning</severity>
							</update>
						</transaction>
						<transaction>
							<update>
								<property>state/@severity</property>
								<severity>ok</severity>
							</update>
						</transaction>
					</if>
				</block>
			</rule>
			<rule name="tcp_links_availability">
				<targets>
					<target>/geneos/gateway/directory/probe/managedEntity/sampler[@type=&quot;baseline&quot;]/dataview[@name=&quot;tcp_links&quot;]/rows/row/cell[@column=&quot;Availability&quot;]</target>
				</targets>
				<priority>18</priority>
				<block>
					<if>
						<equal>
							<dataItem>
								<property>@value</property>
							</dataItem>
							<string/>
						</equal>
						<transaction>
							<update>
								<property>state/@severity</property>
								<severity>undefined</severity>
							</update>
						</transaction>
					</if>
					<if>
						<like>
							<dataItem>
								<property>@value</property>
							</dataItem>
							<string>absent</string>
						</like>
						<transaction>
							<update>
								<property>state/@severity</property>
								<severity>warning</severity>
							</update>
						</transaction>
						<transaction>
							<update>
								<property>state/@severity</property>
								<severity>ok</severity>
							</update>
						</transaction>
					</if>
				</block>
			</rule>
			<rule disabled="true" name="fkm_fail_triggerdetails02">
				<targets>
					<target>/geneos/gateway/directory/probe/managedEntity/sampler[(param(&quot;PluginName&quot;)=&quot;FKM&quot;)]/dataview/rows/row[contains(@name,&quot;#fail&quot;)]/cell[(@column=&quot;triggerDetails&quot;)]</target>
				</targets>
				<priority>19</priority>
				<block>
					<if>
						<equal>
							<dataItem>
								<property>@value</property>
							</dataItem>
							<string/>
						</equal>
						<transaction>
							<update>
								<property>state/@severity</property>
								<severity>undefined</severity>
							</update>
						</transaction>
					</if>
					<transaction>
						<update>
							<property>state/@severity</property>
							<severity>critical</severity>
						</update>
					</transaction>
				</block>
			</rule>
			<rule disabled="true" name="fkm_warning_triggerdetails02">
				<targets>
					<target>/geneos/gateway/directory/probe/managedEntity/sampler[(param(&quot;PluginName&quot;)=&quot;FKM&quot;)]/dataview/rows/row[contains(@name,&quot;#warning&quot;)]/cell[(@column=&quot;triggerDetails&quot;)]</target>
				</targets>
				<priority>20</priority>
				<block>
					<if>
						<equal>
							<dataItem>
								<property>@value</property>
							</dataItem>
							<string/>
						</equal>
						<transaction>
							<update>
								<property>state/@severity</property>
								<severity>undefined</severity>
							</update>
						</transaction>
					</if>
					<transaction>
						<update>
							<property>state/@severity</property>
							<severity>warning</severity>
						</update>
					</transaction>
				</block>
			</rule>
			<rule name="fkm_status02">
				<targets>
					<target>/geneos/gateway/directory/probe/managedEntity/sampler[(param(&quot;PluginName&quot;)=&quot;FKM&quot;)]/dataview/rows/row/cell[(@column=&quot;status&quot;)]</target>
				</targets>
				<priority>21</priority>
				<block>
					<if>
						<equal>
							<dataItem>
								<property>@value</property>
							</dataItem>
							<string/>
						</equal>
						<transaction>
							<update>
								<property>state/@severity</property>
								<severity>undefined</severity>
							</update>
						</transaction>
					</if>
					<if>
						<like>
							<dataItem>
								<property>@value</property>
							</dataItem>
							<string>WARNING*</string>
						</like>
						<transaction>
							<update>
								<property>state/@severity</property>
								<severity>warning</severity>
							</update>
						</transaction>
						<if>
							<like>
								<dataItem>
									<property>@value</property>
								</dataItem>
								<string>FAIL*</string>
							</like>
							<transaction>
								<update>
									<property>state/@severity</property>
									<severity>critical</severity>
								</update>
							</transaction>
							<transaction>
								<update>
									<property>state/@severity</property>
									<severity>ok</severity>
								</update>
							</transaction>
						</if>
					</if>
				</block>
			</rule>
			<rule name="processes_instancecount">
				<targets>
					<target>/geneos/gateway/directory/probe/managedEntity/sampler/dataview/rows/row/cell[(@column=&quot;instanceCount&quot;)]</target>
				</targets>
				<priority>22</priority>
				<block>
					<if>
						<equal>
							<dataItem>
								<property>@value</property>
							</dataItem>
							<string/>
						</equal>
						<transaction>
							<update>
								<property>state/@severity</property>
								<severity>undefined</severity>
							</update>
						</transaction>
					</if>
					<if>
						<lt>
							<dataItem>
								<property>@value</property>
							</dataItem>
							<integer>1</integer>
						</lt>
						<transaction>
							<update>
								<property>state/@severity</property>
								<severity>critical</severity>
							</update>
						</transaction>
						<transaction>
							<update>
								<property>state/@severity</property>
								<severity>ok</severity>
							</update>
						</transaction>
					</if>
				</block>
			</rule>
			<rule name="ftm_delay">
				<targets>
					<target>/geneos/gateway/directory/probe/managedEntity/sampler[(@type=&quot;baseline&quot;)]/dataview[(@name=&quot;ftm&quot;)]/rows/row/cell[(@column=&quot;Delay&quot;)]</target>
				</targets>
				<priority>23</priority>
				<block>
					<if>
						<equal>
							<dataItem>
								<property>@value</property>
							</dataItem>
							<string/>
						</equal>
						<transaction>
							<update>
								<property>state/@severity</property>
								<severity>undefined</severity>
							</update>
						</transaction>
					</if>
					<if>
						<gt>
							<dataItem>
								<property>@value</property>
							</dataItem>
							<integer>300</integer>
						</gt>
						<transaction>
							<update>
								<property>state/@severity</property>
								<severity>warning</severity>
							</update>
						</transaction>
						<transaction>
							<update>
								<property>state/@severity</property>
								<severity>ok</severity>
							</update>
						</transaction>
					</if>
				</block>
			</rule>
			<rule name="top_numbreached">
				<targets>
					<target>/geneos/gateway/directory/probe/managedEntity/sampler[(@type=&quot;baseline&quot;)]/dataview[wild(@name,&quot;top_*&quot;)]/headlines/cell[(@name=&quot;numBreached&quot;)]</target>
				</targets>
				<priority>24</priority>
				<block>
					<if>
						<equal>
							<dataItem>
								<property>@value</property>
							</dataItem>
							<string/>
						</equal>
						<transaction>
							<update>
								<property>state/@severity</property>
								<severity>undefined</severity>
							</update>
						</transaction>
					</if>
					<if>
						<gt>
							<dataItem>
								<property>@value</property>
							</dataItem>
							<integer>15</integer>
						</gt>
						<transaction>
							<update>
								<property>state/@severity</property>
								<severity>warning</severity>
							</update>
						</transaction>
						<transaction>
							<update>
								<property>state/@severity</property>
								<severity>ok</severity>
							</update>
						</transaction>
					</if>
				</block>
			</rule>
			<rule name="win-services_status">
				<targets>
					<target>/geneos/gateway/directory/probe[(@name=&quot;192_168_31_1_7037&quot;)]/managedEntity[(@name=&quot;winvista-standard&quot;)]/sampler[(@name=&quot;win-services&quot;)][(@type=&quot;windows&quot;)]/dataview[(@name=&quot;win-services&quot;)]/rows/row/cell[(@column=&quot;status&quot;)]</target>
				</targets>
				<priority>25</priority>
				<block>
					<if>
						<equal>
							<dataItem>
								<property>@value</property>
							</dataItem>
							<string/>
						</equal>
						<transaction>
							<update>
								<property>state/@severity</property>
								<severity>undefined</severity>
							</update>
						</transaction>
					</if>
					<if>
						<unlike>
							<dataItem>
								<property>@value</property>
							</dataItem>
							<string>Running</string>
						</unlike>
						<transaction>
							<update>
								<property>state/@severity</property>
								<severity>critical</severity>
							</update>
						</transaction>
						<transaction>
							<update>
								<property>state/@severity</property>
								<severity>ok</severity>
							</update>
						</transaction>
					</if>
				</block>
			</rule>
			<rule name="device_io_queue">
				<targets>
					<target>/geneos/gateway/directory/probe/managedEntity/sampler/dataview[(@name=&quot;DEVICEIO-LINUX&quot;)]/rows/row/cell[(@column=&quot;aveQueueLen&quot;)]</target>
				</targets>
				<priority>1</priority>
				<block>
					<if>
						<gt>
							<dataItem>
								<property>@value</property>
							</dataItem>
							<integer>1000</integer>
						</gt>
						<transaction>
							<update>
								<property>state/@severity</property>
								<severity>critical</severity>
							</update>
						</transaction>
						<if>
							<gt>
								<dataItem>
									<property>@value</property>
								</dataItem>
								<integer>500</integer>
							</gt>
							<transaction>
								<update>
									<property>state/@severity</property>
									<severity>warning</severity>
								</update>
							</transaction>
							<transaction>
								<update>
									<property>state/@severity</property>
									<severity>ok</severity>
								</update>
							</transaction>
						</if>
					</if>
				</block>
			</rule>
			<rule name="ipc_active">
				<targets>
					<target>/geneos/gateway/directory/probe/managedEntity/sampler/dataview[(@name=&quot;IPCS-LINUX&quot;)]/headlines/cell[(@name=&quot;activeSegments&quot;)]</target>
				</targets>
				<priority>1</priority>
				<block>
					<if>
						<lt>
							<dataItem>
								<property>@value</property>
							</dataItem>
							<integer>2</integer>
						</lt>
						<transaction>
							<update>
								<property>state/@severity</property>
								<severity>warning</severity>
							</update>
						</transaction>
						<transaction>
							<update>
								<property>state/@severity</property>
								<severity>ok</severity>
							</update>
						</transaction>
					</if>
				</block>
			</rule>
		</ruleGroup>
	</rules>
	<databaseLogging>
		<enabled>true</enabled>
		<connection>
			<database>
				<mysql>
					<serverName>localhost</serverName>
					<databaseName>GENEOS</databaseName>
					<port>3306</port>
				</mysql>
			</database>
		</connection>
		<tables>
			<table name="os_table">
				<type>string</type>
			</table>
		</tables>
		<items>
			<item name="cpu_percentutilisation">
				<targets>
					<target>/geneos/gateway[(@name=&quot;ETT UK&quot;)]/directory/probe[(@name=&quot;GenericProbe2&quot;)]/managedEntity[(@name=&quot;LON020ALGO&quot;)]/sampler[(@name=&quot;cpu-linux&quot;)][(@type=&quot;unix&quot;)]/dataview[(@name=&quot;cpu-linux&quot;)]/rows/row/cell[wild(@column,&quot;percent*&quot;)]</target>
				</targets>
				<table ref="os_table"/>
			</item>
		</items>
	</databaseLogging>
	<staticVars>
		<fkmTables>
			<fkmTable name="warnings">
				<keys>
					<key>
						<setKey>
							<match>
								<searchString>
									<data>INFO</data>
								</searchString>
							</match>
						</setKey>
					</key>
					<key>
						<setKey>
							<match>
								<searchString>
									<data>WARNING</data>
								</searchString>
							</match>
						</setKey>
					</key>
				</keys>
			</fkmTable>
			<fkmTable name="fails">
				<keys>
					<key>
						<setKey>
							<match>
								<searchString>
									<data>ERROR</data>
								</searchString>
							</match>
						</setKey>
					</key>
					<key>
						<setKey>
							<match>
								<searchString>
									<data>EXCEPTION</data>
								</searchString>
							</match>
						</setKey>
					</key>
				</keys>
			</fkmTable>
		</fkmTables>
	</staticVars>
	<operatingEnvironment>
		<!--The gateway name must be set, the listen port should be set-->
		<gatewayName>ETT UK</gatewayName>
		<listenPort>8073</listenPort>
		<debug>
			<setValue>
				<disableNotifications>true</disableNotifications>
			</setValue>
		</debug>
	</operatingEnvironment>
</gateway>
